[INFO: 2025-10-10 21:31:41,013] Training with config:
[INFO: 2025-10-10 21:31:41,015] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Fix',
                          'WARMUP': 10000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-10 21:33:14,937] Training with config:
[INFO: 2025-10-10 21:33:14,940] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Fix',
                          'WARMUP': 10000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-10 21:52:29,202] Training with config:
[INFO: 2025-10-10 21:52:29,204] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Fix',
                          'WARMUP': 10000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-10 22:23:45,437] Training with config:
[INFO: 2025-10-10 22:23:45,439] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Fix',
                          'WARMUP': 10000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-10 22:28:10,903] Training with config:
[INFO: 2025-10-10 22:28:10,905] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Fix',
                          'WARMUP': 10000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-10 22:35:45,169] Training with config:
[INFO: 2025-10-10 22:35:45,171] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Fix',
                          'WARMUP': 10000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-10 22:39:31,352] Training with config:
[INFO: 2025-10-10 22:39:31,354] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Fix',
                          'WARMUP': 10000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-10 22:43:44,093] Training with config:
[INFO: 2025-10-10 22:43:44,095] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Fix',
                          'WARMUP': 10000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-10 22:44:49,115] Training with config:
[INFO: 2025-10-10 22:44:49,116] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Fix',
                          'WARMUP': 10000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 13:44:53,872] Training with config:
[INFO: 2025-10-12 13:44:53,874] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Fix',
                          'WARMUP': 10000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 13:45:58,936] Training with config:
[INFO: 2025-10-12 13:45:58,938] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Fix',
                          'WARMUP': 10000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 13:56:58,665] Training with config:
[INFO: 2025-10-12 13:56:58,667] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 512,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'SETP_TYPE': 'Iter',
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'TYPE': 'Fix',
                          'WARMUP': 10000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 14:32:49,683] Training with config:
[INFO: 2025-10-12 14:32:49,685] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'END_FACTOR': 0.0,
                          'ETA_MIN': 0,
                          'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'START_FACTOR': 1.0,
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'STEP_TYPE': 'Iter',
                          'TOTAL_ITERS': None,
                          'TYPE': 'Linear',
                          'T_0': None,
                          'T_MAX': None,
                          'T_MULT': 2,
                          'WARMUP': 20000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 14:33:23,578] Training with config:
[INFO: 2025-10-12 14:33:23,580] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'END_FACTOR': 0.0,
                          'ETA_MIN': 0,
                          'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'START_FACTOR': 1.0,
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'STEP_TYPE': 'Iter',
                          'TOTAL_ITERS': None,
                          'TYPE': 'Linear',
                          'T_0': None,
                          'T_MAX': None,
                          'T_MULT': 2,
                          'WARMUP': 20000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 14:39:42,670] Training with config:
[INFO: 2025-10-12 14:39:42,672] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'END_FACTOR': 0.0,
                          'ETA_MIN': 1e-05,
                          'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'START_FACTOR': 1.0,
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'STEP_TYPE': 'Epoch',
                          'TOTAL_ITERS': None,
                          'TYPE': 'CosineAnnealing',
                          'T_0': None,
                          'T_MAX': None,
                          'T_MULT': 2,
                          'WARMUP': 20000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 14:48:06,090] Training with config:
[INFO: 2025-10-12 14:48:06,092] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'END_FACTOR': 0.0,
                          'ETA_MIN': 1e-05,
                          'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'START_FACTOR': 1.0,
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'STEP_TYPE': 'Epoch',
                          'TOTAL_ITERS': None,
                          'TYPE': 'CosineAnnealing',
                          'T_0': None,
                          'T_MAX': None,
                          'T_MULT': 2,
                          'WARMUP': 20000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 14:50:17,264] Training with config:
[INFO: 2025-10-12 14:50:17,265] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'END_FACTOR': 0.0,
                          'ETA_MIN': 0.0,
                          'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'START_FACTOR': 1.0,
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'STEP_TYPE': 'Epoch',
                          'TOTAL_ITERS': None,
                          'TYPE': 'CosineAnnealing',
                          'T_0': None,
                          'T_MAX': None,
                          'T_MULT': 2,
                          'WARMUP': 20000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 14:51:28,406] Training with config:
[INFO: 2025-10-12 14:51:28,408] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'END_FACTOR': 0.0,
                          'ETA_MIN': 0.0,
                          'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'START_FACTOR': 1.0,
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'STEP_TYPE': 'Step',
                          'TOTAL_ITERS': None,
                          'TYPE': 'CosineAnnealing',
                          'T_0': None,
                          'T_MAX': None,
                          'T_MULT': 2,
                          'WARMUP': 20000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 15:25:14,474] Training with config:
[INFO: 2025-10-12 15:25:14,476] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR',
                      'SPICE'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'END_FACTOR': 0.0,
                          'ETA_MIN': 0.0,
                          'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'START_FACTOR': 1.0,
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'STEP_TYPE': 'Iter',
                          'TOTAL_ITERS': None,
                          'TYPE': 'Linear',
                          'T_0': None,
                          'T_MAX': None,
                          'T_MULT': 2,
                          'WARMUP': 20000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 15:27:30,398] Training with config:
[INFO: 2025-10-12 15:27:30,400] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR',
                      'SPICE'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'END_FACTOR': 0.0,
                          'ETA_MIN': 0.0,
                          'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'START_FACTOR': 1.0,
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'STEP_TYPE': 'Iter',
                          'TOTAL_ITERS': None,
                          'TYPE': 'Linear',
                          'T_0': None,
                          'T_MAX': None,
                          'T_MULT': 2,
                          'WARMUP': 20000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 15:33:53,899] Training with config:
[INFO: 2025-10-12 15:33:53,901] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR',
                      'SPICE'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'END_FACTOR': 0.0,
                          'ETA_MIN': 0.0,
                          'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'START_FACTOR': 1.0,
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'STEP_TYPE': 'Iter',
                          'TOTAL_ITERS': None,
                          'TYPE': 'Linear',
                          'T_0': None,
                          'T_MAX': None,
                          'T_MULT': 2,
                          'WARMUP': 20000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 15:36:46,613] Training with config:
[INFO: 2025-10-12 15:36:46,615] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR',
                      'SPICE'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'END_FACTOR': 0.0,
                          'ETA_MIN': 0.0,
                          'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'START_FACTOR': 1.0,
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'STEP_TYPE': 'Iter',
                          'TOTAL_ITERS': None,
                          'TYPE': 'Linear',
                          'T_0': None,
                          'T_MAX': None,
                          'T_MULT': 2,
                          'WARMUP': 20000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 16:51:23,213] Training with config:
[INFO: 2025-10-12 16:51:23,215] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR',
                      'SPICE'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'END_FACTOR': 0.0,
                          'ETA_MIN': 0.0,
                          'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'START_FACTOR': 1.0,
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'STEP_TYPE': 'Iter',
                          'TOTAL_ITERS': None,
                          'TYPE': 'Linear',
                          'T_0': None,
                          'T_MAX': None,
                          'T_MULT': 2,
                          'WARMUP': 20000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 16:52:43,910] Training with config:
[INFO: 2025-10-12 16:52:43,912] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR',
                      'SPICE'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'END_FACTOR': 0.0,
                          'ETA_MIN': 0.0,
                          'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'START_FACTOR': 1.0,
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'STEP_TYPE': 'Iter',
                          'TOTAL_ITERS': None,
                          'TYPE': 'Linear',
                          'T_0': None,
                          'T_MAX': None,
                          'T_MULT': 2,
                          'WARMUP': 20000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 16:53:42,155] Training with config:
[INFO: 2025-10-12 16:53:42,157] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR',
                      'SPICE'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'END_FACTOR': 0.0,
                          'ETA_MIN': 0.0,
                          'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'START_FACTOR': 1.0,
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'STEP_TYPE': 'Iter',
                          'TOTAL_ITERS': None,
                          'TYPE': 'Linear',
                          'T_0': None,
                          'T_MAX': None,
                          'T_MULT': 2,
                          'WARMUP': 20000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
[INFO: 2025-10-12 17:26:21,470] Training with config:
[INFO: 2025-10-12 17:26:21,472] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SEQ_PATH': '',
                 'MAX_FEAT': -1,
                 'NUM_WORKERS': 8,
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 5,
                 'SHUFFLE': False,
                 'TARGET_SEQ_PATH': '',
                 'TEST_4W_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TEST_ATT_FEATS': '',
                 'TEST_GV_FEAT': '',
                 'TEST_ID': './PureT/data/coco_karpathy/validation_ids.json',
                 'TRAIN_ATT_FEATS': '',
                 'TRAIN_GV_FEAT': '',
                 'TRAIN_ID': './PureT/data/coco_karpathy/train_ids.json',
                 'VAL_ATT_FEATS': '',
                 'VAL_GV_FEAT': '',
                 'VAL_ID': './PureT/data/coco_karpathy/validation_ids.json'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 5,
               'CAP_KEY': 'caption',
               'COCO_PATH': './coco-caption',
               'EVAL': 'CocoHFEvaluer',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': './PureT/data/coco_karpathy/captions_test.json',
               'VAL_ANNFILE': './PureT/data/coco_karpathy/captions_validation.json',
               'VOCAB': './PureT/data/coco_karpathy/coco_vocabulary.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 192,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 512,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 512,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [64, 32, 64],
                        'DECODE_ATT_MID_DROPOUT': 0.1,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.1,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 3,
                        'DIM': 512,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [64, 32, 64],
                        'ENCODE_ATT_MID_DROPOUT': 0.1,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.1,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.1,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 3,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.1,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.1,
           'DROPOUT_WORD_EMBED': 0.1,
           'GVFEAT_DIM': 1,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 512,
           'SEQ_LEN': 17,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'PureT_byteformer',
           'VOCAB_SIZE': 9487,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 512,
           'WORD_EMBED_NORM': True},
 'PARAM': {'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'STATE': 'STATE',
           'TARGET_SENT': 'TARGET_SENT',
           'WT': 'WT'},
 'ROOT_DIR': 'PureT/experiments/ByteCaption_XE',
 'SCORER': {'CIDER_CACHED': 'coco_train_cider.pkl',
            'GT_PATH': 'coco_train_gts.pkl',
            'TYPES': ['Bleu_1',
                      'Bleu_2',
                      'Bleu_3',
                      'Bleu_4',
                      'ROUGE_L',
                      'CIDEr',
                      'METEOR',
                      'SPICE'],
            'WEIGHTS': [0.1, 0.1, 0.1, 0.2, 0.1, 0.3, 0.1, 0.1]},
 'SEED': 1234.0,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.98], 'EPS': 1e-09},
            'BASE_LR': 5e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 20,
            'GRAD_CLIP': 0.1,
            'GRAD_CLIP_TYPE': 'Clamp',
            'LR_POLICY': {'END_FACTOR': 0.0,
                          'ETA_MIN': 0.0,
                          'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.5,
                          'PLATEAU_PATIENCE': 3,
                          'START_FACTOR': 1.0,
                          'STEPS': (3,),
                          'STEP_SIZE': 3,
                          'STEP_TYPE': 'Iter',
                          'TOTAL_ITERS': None,
                          'TYPE': 'Linear',
                          'T_0': None,
                          'T_MAX': None,
                          'T_MULT': 2,
                          'WARMUP': 20000},
            'MAX_CHECKPOINTS': 2,
            'MAX_EPOCH': 10,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 25},
 'TRAIN': {'BATCH_SIZE': 10,
           'REINFORCEMENT': {'START': 9999},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
